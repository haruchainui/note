# 6.改进分治算法的途径1：减少子问题数

## 减少子问题个数的依据

分治算法的时间复杂度方程
$$
W(n)=aW(n/b)+d(n)
$$

$$
a:子问题数，n/b:子问题规模，
\\d(n):划分与综合工作量
$$

当a较大，b较小，d(n)不大时，方程的解：
$$
W(n)=\Theta(n^{log_ba})
$$
==减少a时降低函数W(n)的阶的有效途径==

利用子问题的依赖关系，使某些子问题的解通过其他子问题的解而得到

## 例1：整数位乘问题

输入：X，Y是n位二进制数，$n=2^k$

输出：XY

普通乘法：需要$O(n^2)$位乘运算



简单划分，令
$$
\begin{aligned}
&X=A2^{n/2}+B,Y=C2^{n/2}+D\\
&XY=AC2^n+(AD+BC)2^{n/2}+BD
\end{aligned}
$$
![33001](../../assets/6.改进分治算法的途径1：减少子问题数/33001.jpg)

此处相当于XY有四个子函数（a=4），每个子函数的规模为（n/2）
$$
W(n)=4W(n)+O(n)\Rightarrow W(n)=O(n^2)
$$

## 减少子问题个数

子问题间的依赖关系：代数变换
$$
AD+BC=(A-B)(D-C)+AC+BD
$$
AC和BD已经计算过依次，所以可以直接使用结果

中间的$(A-B)(D-C)$相当于两个位数不超过n/2的数乘法，

于是将四个未知数减少为三个未知数

算法复杂度：
$$
\begin{aligned}
&W(n)=3W(n/2)+cn\\
&W(1)=1
\end{aligned}
$$
方程的解：
$$
\begin{aligned}
&W(n)=O(n^{log_23})=O(n^{1.59})
\end{aligned}
$$
$O(n^{1.59})<O(n^2)$

## 例2：矩阵相乘问题

输入：A，B为n阶矩阵，$n=2^k$

输出：$C=AB$



通常的矩阵乘法

- C中有$n^2$个元素
- 每个元素需要做n次乘法（n个数和n个数两两相乘）
- 以元素相乘为基本运算

$$
W(n)=O(n^3)
$$

## 简单分治算法

分治法 将矩阵分块，得
$$
\left( \begin{array}{cc|r}
A_{11}&A_{12}\\
A_{21}&A_{22}
\end{array} \right)\left( \begin{array}{cc|r}
B_{11}&B_{12}\\
B_{21}&B_{22}
\end{array} \right)=\left( \begin{array}{cc|r}
C_{11}&C_{12}\\
C_{21}&C_{22}
\end{array} \right)
$$
其中
$$
C_{11}=A_{11}B_{11}+A_{12}B_{21}\\
C_{12}=A_{11}B_{12}+A_{12}B_{22}\\
C_{21}=A_{21}B_{11}+A_{22}B_{21}\\
C_{22}=A_{21}B_{12}+A_{22}B_{22}\\
$$
递推方程
$$
\begin{aligned}
&W(n)=8W(n/2)+cn^2\\
&W(1)=1\\
解得\ \ \ \  \ &W(n)=O(n^3)
\end{aligned}
$$
没有改进时间复杂度

## Strassen矩阵乘法

变换方法

设计$M_1,M_2,M_3,...,M_7$,对应七个子问题
$$
\begin{aligned}
\\&M_1=A_{11}(B_{12}-B_{22})
\\&M_2=(A_{11}+A_{12})B_{12}
\\&M_3=(A_{21}+A_{22})B_{11}
\\&M_4=A_{22}(B_{21}-B_{11})
\\&M_5=(A_{11}+A_{22})(B_{11}+B_{22})
\\&M_6=(A_{12}-A_{22})(B_{21}+B_{22})
\\&M_7=(A_{11}-A_{21})(B_{11}+B_{12})
\end{aligned}
$$
利用中间矩阵，得到结果矩阵
$$
\begin{array}
\\&C_{11}=M_5+M_4-M_2+M_6
\\&C_{12}=M_1+M_2
\\&C_{21}=M_3+M_4
\\&C_{22}=M_5+M_1-M_3-M_7
\end{array}
$$


时间复杂度
$$
\begin{aligned}
&W(n)=7W(n/2)+18(n/2)^2
\\&W(1)=1
\\解得\ \ \ \ &W(n)=O(n^{log7})=O(n^{2.8075})
\end{aligned}
$$

## 矩阵乘法的研究及应用

矩阵乘法问题的难度

- Coppersmith-Winograd算法:$O(n^{2.376})$

  是目前最好的上界

- 目前位置最好的下界是$\Omega(n^2)$

应用：

- 科学计算、图像处理、数据挖掘等
- 回归、据类、主成分分析、决策树等挖掘算法常涉及大规模矩阵运算

## 改进途径小结

- 适用于：子问题太多，划分和综合工作量不太大，时间复杂度函数

$$
W(n)=\Theta(n^{log_ba})
$$

- 利用子问题依赖关系，用某些子问题的解的代数表达式表示另一些子问题的解，减少独立计算子问题个数
- 综合解的工作量可能会增加，但增加的工作量不影响$W(n)$的阶